%%%%%%%%%%%%
%%%%%%%%%%%%
\begin{figure}
\centering
%%%%%%%%%%%%
\begin{subfigure}[t]{.4\textwidth}
	\centering
	\begin{tikzpicture}[	trim axis left, trim axis right, font=\footnotesize,
					upper/.style={	name path=upper, smooth, draw=none},
					lower/.style={	name path=lower, smooth, draw=none},]
		\begin{axis}[	xmin=0, xmax=200000, scale=0.75,
					ymin=-12, ymax=0,
					scaled x ticks=false,
					xtick={0,50000,100000,150000,200000},
					xticklabels={$0$,$50k$,$100k$,$150k$,$200k$},
					legend cell align=left, legend pos=south east,
					legend style={nodes={scale=0.8, transform shape}},
					grid=major, xlabel=transitions, ylabel=score]
				
			\legend{1 jet, 3 jets}
		
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_1_jet_1_env.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_1_jet_1_env.dat}; 
			\addplot [fill=blue3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=blue1, thick, smooth] 			table[x index=0,y index=5] {fig/shkadov/ppo_1_jet_1_env.dat}; 
			
%			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_3_jet_1_env.dat};
%			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_3_jet_1_env.dat}; 
%			\addplot [fill=orange3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
%			\addplot[draw=orange1, thick, smooth] 		table[x index=0,y index=5] {fig/shkadov/ppo_3_jet_1_env.dat}; 
			
		\end{axis}
	\end{tikzpicture}
    	\caption{Score curves for different number of jets, using a single environment}
	\label{fig:shkadov_transitions}
\end{subfigure} \qquad
\begin{subfigure}[t]{.4\textwidth}
	\centering
	\begin{tikzpicture}[	trim axis left, trim axis right, font=\footnotesize,
					upper/.style={	name path=upper, smooth, draw=none},
					lower/.style={	name path=lower, smooth, draw=none},]
		\begin{axis}[	xmin=0, xmax=1350, scale=0.75,
					ymin=-12, ymax=0,
					scaled x ticks=false,
					xtick={0,400,800,1200},
					/pgf/number format/1000 sep={},
					legend cell align=left, legend pos=south east,
					legend style={nodes={scale=0.8, transform shape}},
					grid=major, xlabel=walltime (s), ylabel=score]
				
			\legend{1 env, 2 envs, 4 envs}
			
			%1 env
			%global 1350
			%solver 1100
			%training 45
		
			\addplot [upper, forget plot] 				table[x expr=\thisrowno{0}/200000*1350,y index=7] {fig/shkadov/ppo_1_jet_1_env.dat};
			\addplot [lower, forget plot] 				table[x expr=\thisrowno{0}/200000*1350,y index=6] {fig/shkadov/ppo_1_jet_1_env.dat}; 
			\addplot [fill=blue3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=blue1, thick, smooth] 			table[x expr=\thisrowno{0}/200000*1350,y index=5] {fig/shkadov/ppo_1_jet_1_env.dat}; 
			
			%2 envs
			%global 760
			%solver 600
			%training 45
			
			\addplot [upper, forget plot] 				table[x expr=\thisrowno{0}/200000*760,y index=7] {fig/shkadov/ppo_1_jet_2_env.dat};
			\addplot [lower, forget plot] 				table[x expr=\thisrowno{0}/200000*760,y index=6] {fig/shkadov/ppo_1_jet_2_env.dat}; 
			\addplot [fill=orange3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=orange1, thick, smooth] 		table[x expr=\thisrowno{0}/200000*760,y index=5] {fig/shkadov/ppo_1_jet_2_env.dat}; 
			
			%4 envs
			%global 460
			%solver 350
			%training 45
			
			\addplot [upper, forget plot] 				table[x expr=\thisrowno{0}/200000*460,y index=7] {fig/shkadov/ppo_1_jet_4_env.dat};
			\addplot [lower, forget plot] 				table[x expr=\thisrowno{0}/200000*460,y index=6] {fig/shkadov/ppo_1_jet_4_env.dat}; 
			\addplot [fill=bluegray3, opacity=0.5, forget plot] fill between[of=upper and lower];
			\addplot[draw=bluegray1, thick, smooth] 		table[x expr=\thisrowno{0}/200000*460,y index=5] {fig/shkadov/ppo_1_jet_4_env.dat}; 
			
		\end{axis}
	\end{tikzpicture}
    	\caption{Score curves for different number of parallel environments, using a single jet}
	\label{fig:shkadov_walltime}
\end{subfigure}
%%%%%%%%%%%%
\caption{\textbf{Solving the Shkadov environment} with the \ppo algorithm.} 
\label{fig:shkadov_1_jet}
\end{figure} 
%%%%%%%%%%%%
%%%%%%%%%%%%