%%%%%%%%%%%%
%%%%%%%%%%%%
\begin{figure}
\centering
%%%%%%%%%%%%
\begin{subfigure}[t]{.4\textwidth}
	\centering
	\begin{tikzpicture}[	trim axis left, trim axis right, font=\scriptsize,
					upper/.style={	name path=upper, smooth, draw=none},
					lower/.style={	name path=lower, smooth, draw=none},]
		\begin{axis}[	xmin=0, xmax=300000, scale=0.75,
					ymin=-12, ymax=0,
					scaled x ticks=false,
					xtick={0, 100000, 200000, 300000},
					xticklabels={$0$,$100k$,$200k$,$300k$},
					legend cell align=left, legend pos=south east,
					legend style={nodes={scale=0.8, transform shape}},
					every tick label/.append style={font=\scriptsize},
					grid=major, xlabel=transitions, ylabel=score]
				
			\legend{1 jet, 5 jets, 10 jets}
		
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_1_jet_1_env.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_1_jet_1_env.dat}; 
			\addplot [fill=blue3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=blue1, thick, smooth] 			table[x index=0,y index=5] {fig/shkadov/ppo_1_jet_1_env.dat}; 
			
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_5_jets_1_env.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_5_jets_1_env.dat}; 
			\addplot [fill=gray3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=gray1, thick, smooth] 		table[x index=0,y index=5] {fig/shkadov/ppo_5_jets_1_env.dat}; 

			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_10_jets_1_env.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_10_jets_1_env.dat}; 
			\addplot [fill=green3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=green1, thick, smooth] 		table[x index=0,y index=5] {fig/shkadov/ppo_10_jets_1_env.dat}; 
			
		\end{axis}
	\end{tikzpicture}
    	\caption{Score curves for different number of jets using the \textsc{ppo} algorithm}
	\label{fig:shkadov_base}
\end{subfigure} \qquad
\begin{subfigure}[t]{.4\textwidth}
	\centering
	\begin{tikzpicture}[	trim axis left, trim axis right, font=\scriptsize,
					upper/.style={	name path=upper, smooth, draw=none},
					lower/.style={	name path=lower, smooth, draw=none},]
		\begin{axis}[	xmin=0, xmax=300000, scale=0.75,
					ymin=-12, ymax=0,
					scaled x ticks=false,
					xtick={0, 100000, 200000, 300000},
					xticklabels={$0$,$100k$,$200k$,$300k$},
					legend cell align=left, legend pos=south east,
					legend style={nodes={scale=0.8, transform shape}},
					every tick label/.append style={font=\scriptsize},
					grid=major, xlabel=walltime (s), ylabel=score]
				
			\legend{\textsc{ppo}}
		
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_10_jets_1_env.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_10_jets_1_env.dat}; 
			\addplot [fill=green3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=green1, thick, smooth] 		table[x index=0,y index=5] {fig/shkadov/ppo_10_jets_1_env.dat}; 
			
		\end{axis}
	\end{tikzpicture}
    	\caption{Score curves for 10 jets using different agents}
	\label{fig:shkadov_agents}
\end{subfigure}
%%%%%%%%%%%%
\caption{\textbf{Solving the Shkadov environment.} Left: solving for different number of jets with the \textsc{ppo} algorithm; Right: solving for 10 jets using \textsc{ppo}, \textsc{td3} and \textsc{sac}. For each curve, we plot the average (solid color) and the standard deviation (shaded color) obtained from $5$ different runs.} 
\label{fig:shkadov_results}
\end{figure} 
%%%%%%%%%%%%
%%%%%%%%%%%%