%%%%%%%%%%%%
%%%%%%%%%%%%
\begin{figure}
\centering
%%%%%%%%%%%%
\begin{subfigure}[t]{.33\textwidth}
	\centering
	\begin{tikzpicture}[	trim axis left, trim axis right, font=\scriptsize,
					upper/.style={	name path=upper, smooth, draw=none},
					lower/.style={	name path=lower, smooth, draw=none},]
		\begin{axis}[	xmin=0, xmax=200000, scale=0.75,
					ymin=-4, ymax=0,
					scaled x ticks=false,
					xtick={0, 50000, 100000, 150000, 200000},
					xticklabels={$0$,$50k$,$100k$,$150k$,$200k$},
					legend cell align=left, legend pos=south west,
					legend style={nodes={scale=0.8, transform shape}},
					every tick label/.append style={font=\scriptsize},
					grid=major, xlabel=transitions, ylabel=score]
				
			\legend{no control, \ppo, \ddpg}
		
			\addplot[thick, opacity=0.7, dash pattern=on 2pt]	coordinates {(0,-2.90) (200000,-2.90)};
		
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_5_jets.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_5_jets.dat}; 
			\addplot [fill=blue3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=blue1, thick, smooth] 			table[x index=0,y index=5] {fig/shkadov/ppo_5_jets.dat}; 
			
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ddpg.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ddpg.dat}; 
			\addplot [fill=gray3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=gray1, thick, smooth] 			table[x index=0,y index=5] {fig/shkadov/ddpg.dat}; 
			
		\end{axis}
	\end{tikzpicture}
	\caption{Comparison of \ppo and \ddpg with 5 jets}
\end{subfigure} \qquad \qquad
%%%%%%%%%%%%
\begin{subfigure}[t]{.33\textwidth}
	\centering
	\begin{tikzpicture}[	trim axis left, trim axis right, font=\scriptsize,
					upper/.style={	name path=upper, smooth, draw=none},
					lower/.style={	name path=lower, smooth, draw=none},]
		\begin{axis}[	xmin=0, xmax=200000, scale=0.75,
					ymin=-4, ymax=0,
					scaled x ticks=false,
					xtick={0, 50000, 100000, 150000, 200000},
					xticklabels={$0$,$50k$,$100k$,$150k$,$200k$},
					legend cell align=left, legend pos=south east,
					legend style={nodes={scale=0.8, transform shape}},
					every tick label/.append style={font=\scriptsize},
					grid=major, xlabel=transitions, ylabel=score]
				
			\legend{no control, 1 jet, 5 jets, 10 jets}
		
			\addplot[thick, opacity=0.7, dash pattern=on 2pt]	coordinates {(0,-2.90) (200000,-2.90)};
		
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_1_jet.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_1_jet.dat}; 
			\addplot [fill=gray3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=gray1, thick, smooth] 			table[x index=0,y index=5] {fig/shkadov/ppo_1_jet.dat}; 
			
			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_5_jets.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_5_jets.dat}; 
			\addplot [fill=blue3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=blue1, thick, smooth] 			table[x index=0,y index=5] {fig/shkadov/ppo_5_jets.dat}; 

			\addplot [upper, forget plot] 				table[x index=0,y index=7] {fig/shkadov/ppo_10_jets.dat};
			\addplot [lower, forget plot] 				table[x index=0,y index=6] {fig/shkadov/ppo_10_jets.dat}; 
			\addplot [fill=green3, opacity=0.5, forget plot] 	fill between[of=upper and lower];
			\addplot[draw=green1, thick, smooth] 		table[x index=0,y index=5] {fig/shkadov/ppo_10_jets.dat}; 
			
		\end{axis}
	\end{tikzpicture}
	\caption{\ppo algorithm with different number of jets}
\end{subfigure}
%%%%%%%%%%%%
\caption{\textbf{Score curves for the \codeinline{shkadov-v0} environment.} (Left) Comparison of \ppo and \ddpg algorithms. (Right) Comparison of the \ppo algorithm for different number of jets. For each curve, we plot the average (solid color) and the standard deviation (shaded color) obtained from $n_\text{training} = 5$ different runs. The dashed line indicates the reward obtained for the uncontrolled environment.} 
\label{fig:shkadov_score}
\end{figure} 
%%%%%%%%%%%%
%%%%%%%%%%%%