%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Burgers}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Physics}

The inviscid Burgers equation was first introduced by Bateman in 1915, and models the behavior of a one-dimensional inviscid incompressible fluid flow \cite{bateman1915}, before being studied by Burgers in 1948 \cite{burgers1948}:

\begin{equation}
\label{eq:burgers}
	\dpart{u}{t} + u \dpart{u}{x} = 0.
\end{equation}

We consider the resolution of the Burgers equation on a domain of length $L$, along with the following initial and boundary conditions:

\begin{equation}
\label{eq:burgers_bc}
\begin{split}
	u(x,0)	&= u_\text{target}, \\
	u(0,t) 	&= u_\text{target} + \mathcal{U} ( -\sigma, \sigma), \\
	\dpart{u}{x} (L,t) &= 0,
\end{split}
\end{equation}

where $\sigma$ is the noise level introduced at the inlet, and $u_\text{target}$ is a constant value. The convection of the random inlet signal leads to a noisy solution in the domain, as is depicted in figure \ref{fig:burgers_free}. The initial perturbations steepen while propagating downstream to eventually form shocks.

\input{fig/burgers/free}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discretization}

The Burgers equation (\ref{eq:burgers}) is discretized in time with a finite volume approach. The convective term is discretized using a TVD scheme with a Van Leer flux limiter, while the time marching is performed using a second-order finite-difference scheme.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Environment}

The goal of the environment is to control a pointwise forcing source term $a(t)$ on the right-hand side of (\ref{eq:burgers}), in order to damp the noise transported from the inlet. The forcing is applied at $x_p = 0.3$, while the length of the domain is set to $L=1$. The actions provided to the environment, which are expected to be in $\left[-1, 1\right]$, are then scale by an \textit{ad-hoc} non-dimensional amplitude factor $A=10$. The field is initially set equal to $u_\text{target} = 0.5$, and the variance of the inlet noise is chosen equal to $\sigma = 0.1$. The spatial discretization step is set to $\Delta x = \num{2e-3}$, while the numerical time-step is equal to $\Delta t = \num{4e-3}$ time units. The action duration is set to $\Delta t_\text{act} = 0.05$ time units, for a total episode duration equal to $10$ time units, corresponding to $200$ actions. The observations provided to the agent are the $n_\text{obs} = 20$ values of $u$ upstream of the actuator. Finally, the reward is computed as:

\begin{equation}
\label{eq:burgers_reward}
	r(t) = - \Delta x \norm{u(x,t) - u_\text{target}}_2 \text{ withÂ } x \in \left[ x_p, L \right].
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}

The environment as described in the previous section is referred to as \codeinline{burgers-v0}, in the fashion of the \textsc{gym} environments (the default parameters of the environment are provided in table \ref{table:burgers_parameters}). In this section, we provide some results related to its resolution using a \ppo agent (see the general hyperparameters in table \ref{table:default_ppo_parameters}). For the training, we set $n_\text{rollout} = 4000$, $n_\text{batch} = 2$, $n_\text{epoch} = 32$ and $n_\text{max} = 500k$.

The score curve is shown in figure \ref{fig:burgers_score}, while a plot of the time evolutions of the controlled environment is shown in figure \ref{fig:burgers_control}. As can be observed, the agent successfully damps the transported inlet noise following a kind of opposition control strategy.

%%%%%%%%%%%%
%%%%%%%%%%%%
\begin{table}[h!]
    \footnotesize
    \caption{\textbf{Default parameters used for the \codeinline{burgers-v0} environment.}}
    \label{table:burgers_parameters}
    \centering
    \begin{tabular}{rll}
        \toprule
        	\codeinline{L}			& domain length		& $1$\\
        \codeinline{u_target}		& target value			& $0.5$\\
	\codeinline{sigma}		& inlet noise level		& $0.1$\\
	\codeinline{amp}		& control amplitude		& $10$\\
	\codeinline{ctrl_pos}		& control position		& $0.3$\\
        \bottomrule
    \end{tabular}
\end{table}
%%%%%%%%%%%%
%%%%%%%%%%%%
%%
%\input{fig/lorenz/score}
%%%
%\input{fig/lorenz/control}
%
%\input{fig/lorenz/fields}
